(("undefined"!==typeof self?self:this)["webpackJsonphpc_ui_1_1_3"]=("undefined"!==typeof self?self:this)["webpackJsonphpc_ui_1_1_3"]||[]).push([[2],{1046:function(e,t,a){var r=a("5eaa");t=r(!1),t.push([e.i,".dashboard-metrics[data-v-1e72d538] .external-link{position:absolute;left:200px;top:-45px}.dashboard-metrics[data-v-1e72d538] .frame{top:0}.dashboard-metrics.external-link-pull-left[data-v-1e72d538] .external-link{position:absolute;left:10px;top:-47px}",""]),e.exports=t},"291f":function(e,t,a){var r=a("b0f7");r.__esModule&&(r=r.default),"string"===typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);var s=a("0ed3").default;s("45847c8c",r,!0,{sourceMap:!1,shadowMode:!1})},"305c":function(e,t,a){"use strict";var r=a("da25"),s=a("8bbf"),i=a.n(s),n=a("cd6d");t["a"]=i.a.extend({...n["a"],props:{mode:{type:String,default:r["m"]},realMode:{type:String,default:r["m"]},as:{type:String,default:r["u"]},value:{type:Object,required:!0},initialValue:{type:Object,default:null},liveValue:{type:Object,default:null},doneEvent:{type:Boolean,default:!1}}})},3823:function(e,t,a){"use strict";a("58cd")},"4c19":function(e,t,a){var r=a("5eaa");t=r(!1),t.push([e.i,".graph-options[data-v-b7bcaa58],.graph-options .range-refresh[data-v-b7bcaa58]{display:flex;flex-direction:row;justify-content:flex-end}.graph-options[data-v-b7bcaa58]{justify-content:space-between;align-items:center}.graph-options .labeled-select[data-v-b7bcaa58]{width:100px;margin-left:10px}",""]),e.exports=t},"53ac":function(e,t,a){var r=a("1046");r.__esModule&&(r=r.default),"string"===typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);var s=a("0ed3").default;s("51e93ddf",r,!0,{sourceMap:!1,shadowMode:!1})},5755:function(e,t,a){"use strict";a("d651")},"58cd":function(e,t,a){var r=a("4c19");r.__esModule&&(r=r.default),"string"===typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);var s=a("0ed3").default;s("f81ce53e",r,!0,{sourceMap:!1,shadowMode:!1})},"5a41":function(e,t,a){var r=a("5eaa");t=r(!1),t.push([e.i,".simple-box{background:var(--simple-box-bg) 0 0 no-repeat padding-box;box-shadow:0 0 10px var(--simple-box-shadow);border:1px solid var(--simple-box-border);padding:15px}.simple-box .top{line-height:24px;font-size:18px;border-bottom:1px solid var(--simple-box-divider);padding-bottom:15px;margin:0 -15px 10px -15px;padding:0 15px 15px 15px;align-items:center;display:flex .simple-box .top BUTTON;display-padding:0;display-height:fit-content;display-align-self:flex-start}.simple-box .top H2{margin-bottom:0}.simple-box .content{padding:15px}",""]),e.exports=t},6306:function(e,t,a){var r=a("9f15");r.__esModule&&(r=r.default),"string"===typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);var s=a("0ed3").default;s("559fbd48",r,!0,{sourceMap:!1,shadowMode:!1})},8492:function(e,t,a){"use strict";a("8eda")},"8d7c":function(e,t,a){var r=a("e7f7");r.__esModule&&(r=r.default),"string"===typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);var s=a("0ed3").default;s("bc305b52",r,!0,{sourceMap:!1,shadowMode:!1})},"8eda":function(e,t,a){var r=a("b132");r.__esModule&&(r=r.default),"string"===typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);var s=a("0ed3").default;s("8b1557e6",r,!0,{sourceMap:!1,shadowMode:!1})},"9b93":function(e,t,a){"use strict";a("8d7c")},"9f15":function(e,t,a){var r=a("5eaa");t=r(!1),t.push([e.i,".grafana-graph[data-v-eeaaabda]{position:relative;min-height:100%;min-width:100%}.grafana-graph[data-v-eeaaabda] .content{position:relative;display:flex;flex-direction:column;justify-content:center;align-items:center;width:100%;height:100%;padding:0}.grafana-graph[data-v-eeaaabda] .overlay{position:static;background-color:initial}.grafana-graph iframe[data-v-eeaaabda]{position:absolute;left:0;right:0;top:20px;bottom:0;width:100%;height:100%;overflow:hidden}.grafana-graph iframe.loading[data-v-eeaaabda]{visibility:hidden}",""]),e.exports=t},b0f7:function(e,t,a){var r=a("5eaa");t=r(!1),t.push([e.i,".top[data-v-764cb044]{display:flex;position:relative}.top>h2[data-v-764cb044]{flex:1}.close-button[data-v-764cb044]{cursor:pointer;display:flex;align-items:center;justify-content:center;padding:2px}.close-button>i[data-v-764cb044]{font-size:14px;opacity:.5}.close-button[data-v-764cb044]:hover{background-color:var(--wm-closer-hover-bg)}",""]),e.exports=t},b132:function(e,t,a){var r=a("5eaa");t=r(!1),t.push([e.i,".ember-iframe{border:0;left:calc(var(--nav-width) + 70px);height:calc(100vh - var(--header-height));position:absolute;top:var(--header-height);width:calc(100vw - var(--nav-width) - 70px);visibility:show}.ember-iframe-top-banner{top:calc(2em + var(--header-height))}.ember-iframe-one-banner{height:calc(100vh - var(--header-height) - 2em)}.ember-iframe-two-banners{height:calc(100vh - var(--header-height) - 4em)}.ember-iframe-inline{border:0;overflow:hidden}.ember-iframe-hidden{visibility:hidden}",""]),e.exports=t},b45b:function(e,t,a){"use strict";a.d(t,"b",(function(){return l})),a.d(t,"a",(function(){return c}));var r=a("f390"),s=a("4048"),i=a("907c");const n=["100.2.0+up40.1.2","102.0.0+up40.1.2"];function o(e,t){return n.includes(e)?"/k8s/clusters/"+t:"local"===t?"":"/k8s/clusters/"+t}function l(e,t,a,r,i=!0){const n=Object(s["b"])(t);let l=i?`${o(e,a)}${n.path}`:n.path;return n.query.viewPanel&&(l=Object(s["a"])(l,"viewPanel",n.query.viewPanel)),l=Object(s["a"])(l,"orgId",n.query.orgId),l=Object(s["a"])(l,"kiosk",null),Object.entries(r).forEach(e=>{l=Object(s["a"])(l,e[0],e[1])}),l}async function d(e,t,a,i,n="cluster",l=null){if(!Object(r["b"])(t.getters))return!1;const d=Object(s["b"])(i);let c=o(e,a)+"/api/v1/namespaces/cattle-monitoring-system/services/http:rancher-monitoring-grafana:80/proxy/",u="http:rancher-monitoring-grafana:80/proxy/";l&&(c=`${o(e,a)}/api/v1/namespaces/cattle-project-${l}-monitoring/services/http:cattle-project-${l}-monitoring-grafana:80/proxy/`,u=`http:cattle-project-${l}-monitoring-grafana:80/proxy/`);const h=d.path.split(u)[1],p=h.split("/")[1],m=`${c}api/dashboards/uid/${p}`;try{return await t.dispatch(n+"/request",{url:m,redirectUnauthorized:!1}),!0}catch(f){return!1}}async function c(e,t,a,r="cluster",s=null){let n,o="";if(!s&&e.getters[r+"/canList"](i["b"].APP)){var l;try{n=await e.dispatch(r+"/find",{type:i["b"].APP,id:"cattle-monitoring-system/rancher-monitoring"})}catch(u){}o=null===(l=n)||void 0===l?void 0:l.currentVersion}const c=a.map(a=>d(o,e,t,a,r,s));return(await Promise.all(c)).every(e=>e)}},b661:function(e,t,a){"use strict";a("53ac")},c1f8:function(e,t,a){"use strict";var r=function(){var e=this,t=e._self._c;return t("div",{ref:"emberPage",staticClass:"ember-page"},[e.inline?e._e():t("Loading",{attrs:{loading:!e.loaded,mode:"content","no-delay":!0}}),e.inline&&!e.loaded?t("div",{directives:[{name:"clean-html",rawName:"v-clean-html",value:e.t("generic.loading",{},!0),expression:"t('generic.loading', {}, true)"}],staticClass:"inline-loading"}):e._e(),e.error?t("div",{staticClass:"ember-page-error"},[t("div",[e._v(e._s(e.t("embedding.unavailable")))]),t("button",{staticClass:"btn role-primary",on:{click:function(t){return e.initFrame()}}},[e._v(" "+e._s(e.t("embedding.retry"))+" ")])]):e._e()],1)},s=[],i=a("15ca"),n=a("9ce4"),o=(a("462f"),a("907c"));a("9c36"),a("79ad"),a("6f91");const l="manager";var d=a("8535");const c="ember-iframe";let u;const h=6e4;function p(){return document.getElementById(c)}function m(){clearTimeout(u)}function f(){null!==p()&&(u=setTimeout(g,h))}function g(){const e=p();null!==e&&(e.remove(),m())}const b="ember-iframe-hidden",v=3e4,y="windowmanager",w={"global-admin.clusters.index":{name:"c-cluster-product-resource",params:{cluster:"",product:l,resource:o["a"].RANCHER_CLUSTER}},"authenticated.cluster.index":{name:"c-cluster-product-resource",params:{cluster:"",product:l,resource:o["a"].RANCHER_CLUSTER}},"global-admin.catalog":{name:"c-cluster-mcapps-pages-page",params:{cluster:"local",product:"mcapps",page:"catalogs"}},"authenticated.cluster.istio.cluster-setting":{name:"c-cluster-explorer-tools"}};var x={components:{Loading:i["a"]},props:{src:{type:String,required:!0},pop:{type:Boolean,default:!1},inline:{type:String,default:""},forceInlineReuse:{type:Boolean,default:!1},forceNew:{type:Boolean,default:!1}},data(){return{iframeEl:null,loaded:!0,loadRequired:!1,emberCheck:null,error:!1,heightSync:null,frameHeight:-1,frameWidth:-1,wmHeight:-1,showHeaderBanner:!1,showFooterBanner:!1}},computed:{...Object(n["a"])({theme:"prefs/theme"}),...Object(n["a"])(["clusterId","productId"]),...Object(n["b"])("wm",["open"]),locale(){return this.$store.getters["i18n/current"]()}},watch:{theme(e){this.notifyTheme(e)},src(e,t){e!==t&&this.initFrame()},open(e,t){if(e!==t)if(e)this.syncSize();else{clearTimeout(this.heightSync);const e=p();this.heightSync=null,this.wmHeight=-1,e&&(e.style.height="")}},locale(){this.syncLocale()}},mounted(){m(),window.addEventListener("message",this.receiveMessage),this.initFrame()},beforeDestroy(){if(window.removeEventListener("message",this.receiveMessage),this.heightSync&&clearTimeout(this.heightSync),this.inline){const e=p();e&&e.remove()}this.iframeEl&&this.iframeEl.classList.add(b),this.emberCheck&&this.emberCheck.cancel("User left page"),f()},methods:{addBannerClasses(e,t){e&&(e.classList.remove(t+"-top-banner"),e.classList.remove(t+"-one-banner"),e.classList.remove(t+"-two-banners"),this.showHeaderBanner?(e.classList.add(t+"-top-banner"),this.showFooterBanner&&e.classList.add(t+"-two-banners")):this.showFooterBanner&&e.classList.add(t+"-one-banner"))},async initFrame(){const e=await this.$store.getters["management/byId"](o["o"].SETTING,d["b"].BANNERS);try{const t=JSON.parse(e.value);this.showHeaderBanner="true"===t.showHeader,this.showFooterBanner="true"===t.showFooter}catch{}this.loaded=!0,this.loadRequired=!1;let t=p();if(null!==t){const e="true"===t.getAttribute("data-ready"),a="true"===t.getAttribute("data-loaded"),r=!!this.inline&&!this.forceInlineReuse||this.forceNew,s=!!this.inline&&t.parentElement===document.body;e&&!r&&a&&!s||(t.remove(),t=null)}if(null===t&&Object({NODE_ENV:"production",BASE_URL:"/"}).dev)try{this.error=!1,this.loaded=!1,this.emberCheck=this.$axios.CancelToken.source();const e=window.location.origin+"/assets/images/logos/rke.svg",t=await this.$axios.head(e,{timeout:v,cancelToken:this.emberCheck.token});200!==t.status&&(this.loaded=!0,this.error=!0)}catch(r){this.$axios.isCancel(r)||(this.loaded=!0,this.error=!0)}if(!this.error){if(null===t){if(t=document.createElement("iframe"),t.setAttribute("id",c),t.setAttribute("data-testid",c),t.classList.add(b),this.inline){const e=document.getElementById(this.inline);e.appendChild(t)}else document.body.append(t);t.setAttribute("src",this.src)}else{var a;null!==(a=t.contentWindow)&&void 0!==a&&a.scrollTo&&t.contentWindow.scrollTo(0,0),t.contentWindow.postMessage({action:"navigate",name:this.src}),this.notifyTheme(this.theme);const e=t.contentWindow.location.pathname,r=this.trimURL(this.src);r!==e?t.classList.add(b):t.classList.remove(b)}this.iframeEl=t,this.inline?(t.classList.remove("ember-iframe"),t.classList.add("ember-iframe-inline"),t.height=0,this.syncSize()):(t.classList.add("ember-iframe"),t.classList.remove("ember-iframe-inline"),this.addBannerClasses(this.$refs.emberPage,"fixed"),this.addBannerClasses(t,"ember-iframe"),this.open&&this.syncSize())}},syncSize(){this.heightSync&&clearTimeout(this.heightSync),this.heightSync=setTimeout(()=>{this.dosyncSize(),this.syncSize()},500)},dosyncSize(){if(this.inline){const e=p(),t=e.contentWindow.document,a=t.getElementById("application"),r=null===a||void 0===a?void 0:a.offsetHeight;r&&this.frameHeight!==r&&(this.frameHeight=r,e.height=r);const s=document.getElementById(this.inline),i=s.offsetWidth;i&&this.frameWidth!==i&&(this.frameWidth=i,e.width=i)}else{const e=document.getElementById(y);if(e){const t=e.offsetHeight;if(t!==this.wmHeight){const e=p();e.style.height=`calc(100vh - var(--header-height) - ${t}px)`,this.wmHeight=t}}}},notifyTheme(e){const t=p();if(t){const a="light"===e?"ui-light":"ui-dark";t.contentWindow.postMessage({action:"set-theme",name:a})}},trimURL(e){return e&&e.endsWith("/")&&(e=e.substr(0,e.length-1)),e},receiveMessage(e){const t=e.data;if("navigate"===t.action)this.$router.replace({name:"c-cluster-explorer",params:{cluster:t.cluster}});else if("before-navigation"===t.action){if(this.$emit("before-nav",t.target),w[t.target]){const e=w[t.target];if(this.isCurrentRoute(e))return void this.setLoaded(!0);this.setLoaded(!1),this.$router.replace(this.fillRoute(e))}}else if("loading"===t.action)this.setLoaded(!t.state),this.updateFrameVisibility();else if("ready"===t.action){var a;this.iframeEl.contentWindow.postMessage({action:"echo-back"}),this.iframeEl.setAttribute("data-ready",!0);const e=null===(a=this.iframeEl.contentWindow)||void 0===a||null===(a=a.document)||void 0===a?void 0:a.body;this.inline?e.classList.add("embedded-no-overflow"):e.classList.remove("embedded-no-overflow"),this.syncLocale()}else"need-to-load"===t.action?this.loadRequired=!0:"did-transition"===t.action?this.loadRequired||(this.setLoaded(!0),this.updateFrameVisibility(),this.dosyncSize()):"dashboard"===t.action?(this.iframeEl.setAttribute("data-ready",!1),this.$router.replace(t.page)):"reload"===t.action?(this.loaded=!1,this.iframeEl.remove(),this.initFrame()):"logout"===t.action&&(this.loaded=!1,this.iframeEl.remove(),this.initFrame(),this.$store.dispatch("auth/logout"))},setLoaded(e){this.loaded=e,this.iframeEl&&this.iframeEl.setAttribute("data-loaded",e)},updateFrameVisibility(){if(this.loaded&&this.iframeEl){this.iframeEl.classList.remove(b);const e=window.getComputedStyle(document.body).getPropertyValue("--primary"),t=window.getComputedStyle(document.body).getPropertyValue("--primary-text");this.iframeEl.contentWindow.postMessage({action:"colors",primary:e,primaryText:t})}},fillRoute(e){return"object"===typeof e&&e.params&&("cluster"in e.params&&(e.params.cluster=this.clusterId),"product"in e.params&&(e.params.product=this.productId)),e},isCurrentRoute(e){const t=this.$route;if(t.name===e.name){let a=!0;return Object.keys(t.params).forEach(r=>{e.params[r]!==t.params[r]&&(a=!1)}),a}return!1},syncLocale(){var e;const t=p();null===t||void 0===t||null===(e=t.contentWindow)||void 0===e||null===(e=e.ls("user-language"))||void 0===e||e.sideLoadLanguage(this.locale)}}},$=x,_=(a("9b93"),a("8492"),a("d802")),T=Object(_["a"])($,r,s,!1,null,"0c9f6175",null),S=T.exports,k=a("f390");t["a"]={components:{EmberPage:S},data(){const{namespace:e,resource:t,id:a}=this.$route.params,r=this.$store.getters["management/all"](o["o"].PROJECT),s=r.find(t=>!!t.namespaces.find(t=>t.metadata.name===e));let i=null,n=null;if(s&&Object(k["a"])(this.$store.getters)){const r=s.id.replace("/",":");let o;if("pod"!==t){const e=t.split("."),a=2===e.length?e[1]:e[0];o=`workload-metrics/${a}:`}else o="workloads/pod-metrics/",n=`/p/${r}/workloads/${e}:${a}/container-metrics/`;i=`/p/${r}/${o}${e}:${a}`}return{project:s?s.id:null,v1MonitoringUrl:i,v1MonitoringContainerBaseUrl:n}}}},c389:function(e,t,a){"use strict";var r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"dashboard-metrics",class:!e.hasSummaryAndDetail&&"external-link-pull-left"},[t("div",{staticClass:"graph-options mb-10"},[t("DashboardOptions",{attrs:{"has-summary-and-detail":e.hasSummaryAndDetail},model:{value:e.graphOptions,callback:function(t){e.graphOptions=t},expression:"graphOptions"}})],1),t("div",{staticClass:"info"},[e._t("default")],2),t("div",{staticClass:"graphs",style:{height:e.graphHeight}},["detail"===e.graphOptions.type?t("GrafanaDashboard",{key:"'detail'",staticClass:"col span-12 detail",attrs:{"background-color":e.graphBackgroundColor,theme:e.theme,"refresh-rate":e.graphOptions.refreshRate,range:e.graphOptions.range,url:e.detailUrl,vars:e.vars,"modify-prefix":e.modifyPrefix}}):t("GrafanaDashboard",{key:"'summary'",staticClass:"col span-12 summary",attrs:{"background-color":e.graphBackgroundColor,theme:e.theme,"refresh-rate":e.graphOptions.refreshRate,range:e.graphOptions.range,url:e.summaryUrl,vars:e.vars,"modify-prefix":e.modifyPrefix}})],1)])},s=[],i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"graph-options"},[e.hasSummaryAndDetail?t("div",[t("ButtonGroup",{attrs:{options:e.detailSummaryOptions},model:{value:e.value.type,callback:function(t){e.$set(e.value,"type",t)},expression:"value.type"}})],1):t("div",[t("div")]),t("div",{staticClass:"range-refresh"},[t("LabeledSelect",{attrs:{options:e.rangeOptions,label:e.t("graphOptions.range")},model:{value:e.value.range,callback:function(t){e.$set(e.value,"range",t)},expression:"value.range"}}),t("LabeledSelect",{attrs:{options:e.refreshOptions,label:e.t("graphOptions.refresh")},model:{value:e.value.refreshRate,callback:function(t){e.$set(e.value,"refreshRate",t)},expression:"value.refreshRate"}})],1)])},n=[],o=a("cc2d"),l=a("466b"),d={components:{ButtonGroup:o["a"],LabeledSelect:l["a"]},props:{value:{type:Object,required:!0},hasSummaryAndDetail:{type:Boolean,default:!0}},data(){return{range:null,rangeOptions:[{label:this.t("generic.units.time.5m"),value:"5m"},{label:this.t("generic.units.time.1h"),value:"1h"},{label:this.t("generic.units.time.6h"),value:"6h"},{label:this.t("generic.units.time.1d"),value:"1d"},{label:this.t("generic.units.time.7d"),value:"7d"},{label:this.t("generic.units.time.30d"),value:"30d"}],refreshOptions:[{label:this.t("generic.units.time.5s"),value:"5s"},{label:this.t("generic.units.time.10s"),value:"10s"},{label:this.t("generic.units.time.30s"),value:"30s"},{label:this.t("generic.units.time.1m"),value:"1m"},{label:this.t("generic.units.time.5m"),value:"5m"},{label:this.t("generic.units.time.15m"),value:"15m"},{label:this.t("generic.units.time.30m"),value:"30m"},{label:this.t("generic.units.time.1h"),value:"1h"},{label:this.t("generic.units.time.2h"),value:"2h"},{label:this.t("generic.units.time.1d"),value:"1d"}],detailSummaryOptions:[{label:this.t("graphOptions.detail"),value:"detail"},{label:this.t("graphOptions.summary"),value:"summary"}]}}},c=d,u=(a("3823"),a("d802")),h=Object(u["a"])(c,i,n,!1,null,"b7bcaa58",null),p=h.exports,m=function(){var e=this,t=e._self._c;return t("div",{staticClass:"grafana-graph"},[e.error?t("Banner",{staticStyle:{"z-index":"1000"},attrs:{color:"error"}},[t("div",{staticClass:"text-center"},[e._v(" "+e._s(e.t("grafanaDashboard.failedToLoad"))+" "),t("a",{attrs:{href:"#"},on:{click:e.reload}},[e._v(e._s(e.t("grafanaDashboard.reload")))])])]):e._e(),t("iframe",{directives:[{name:"show",rawName:"v-show",value:!e.error,expression:"!error"}],ref:"frame",class:{loading:e.loading,frame:!0},attrs:{src:e.currentUrl,frameborder:"0",scrolling:"no"}}),e.loading?t("div",[t("Loading")],1):e._e(),e.loading||e.error?e._e():t("div",{staticClass:"external-link"},[t("a",{attrs:{href:e.grafanaUrl,target:"_blank",rel:"noopener nofollow"}},[e._v(e._s(e.t("grafanaDashboard.grafana"))+" "),t("i",{staticClass:"icon icon-external-link"})])])],1)},f=[],g=a("15ca"),b=a("6418"),v=a("b45b"),y=a("907c"),w={components:{Banner:b["a"],Loading:g["a"]},props:{url:{type:String,required:!0},vars:{type:Object,default:()=>({})},range:{type:String,default:null},refreshRate:{type:String,default:null},modifyPrefix:{type:Boolean,default:!0},backgroundColor:{type:String,default:"#1b1c21"},theme:{type:String,default:"dark"}},async fetch(){const e=this.$store.getters["currentProduct"].inStore;if(this.$store.getters[e+"/canList"](y["b"].APP))try{const t=await this.$store.dispatch(e+"/find",{type:y["b"].APP,id:"cattle-monitoring-system/rancher-monitoring"});this.monitoringVersion=null===t||void 0===t?void 0:t.currentVersion}catch(t){}},data(){return{loading:!1,error:!1,interval:null,errorTimer:null,monitoringVersion:""}},computed:{currentUrl(){return this.computeUrl()},grafanaUrl(){return this.currentUrl.replace("&kiosk","")},graphWindow(){var e;return null===(e=this.$refs.frame)||void 0===e?void 0:e.contentWindow},graphHistory(){var e;return null===(e=this.graphWindow)||void 0===e?void 0:e.history},graphDocument(){var e;return null===(e=this.graphWindow)||void 0===e?void 0:e.document}},watch:{currentUrl(e){var t;this.graphHistory&&null!==(t=this.graphWindow)&&void 0!==t&&t.angular&&this.graphWindow.location.replace(e)},error(e){e?this.errorTimer=setInterval(()=>{this.reload()},45e3):(clearInterval(this.errorTimer),this.errorTimer=null)}},mounted(){this.$refs.frame.onload=this.inject,this.poll()},beforeDestroy(){this.interval&&clearInterval(this.interval),this.errorTimer&&clearInterval(this.errorTimer)},methods:{poll(){this.interval&&(clearInterval(this.interval),this.interval=null),this.interval=setInterval(()=>{try{var e;const t=null===(e=this.$refs.frame)||void 0===e?void 0:e.contentWindow,a=t.document.getElementsByClassName("alert-error"),r=t.document.getElementsByClassName("panel-info-corner--error"),s=t.document.getElementsByClassName("panel-in-fullscreen"),i=t.document.getElementsByClassName("panel-container"),n=a.length>0||r.length>0,o=s.length>0||i.length>0,l=t.document.getElementsByTagName("pre"),d=l.length>0?l[0].innerText:"",c=d.includes('"status": "Failure"');if(n)throw new Error("An error was detected in the iframe");this.$set(this,"loading",!o),this.$set(this,"error",c)}catch(t){this.$set(this,"error",!0),this.$set(this,"loading",!1),clearInterval(this.interval),this.interval=null}},100)},computeFromTo(){return{from:"now-"+this.range,to:"now"}},computeUrl(){const e=this.url,t=this.$store.getters["currentCluster"].id,a=this.computeParams();return Object(v["b"])(this.monitoringVersion,e,t,a,this.modifyPrefix)},computeParams(){const e={},t=this.computeFromTo();return t.from&&(e.from=t.from),t.to&&(e.to=t.to),this.refreshRate&&(e.refresh=this.refreshRate),Object.keys(this.vars).length>0&&Object.entries(this.vars).forEach(t=>{const a="var-"+t[0];e[a]=t[1]}),e.theme=this.theme,e},reload(e){e&&e.preventDefault(),this.$refs.frame.contentWindow.location.reload(),this.poll()},injectCss(){var e;const t=document.createElement("style");t.innerHTML=`\n        body .grafana-app .dashboard-content {\n          background: ${this.backgroundColor};\n          padding: 0;\n        }\n\n        body .grafana-app .layout {\n          background: ${this.backgroundColor};\n        }\n\n\n        body .grafana-app .dashboard-content .panel-container {\n          background-color: initial;\n          border: none;\n        }\n\n        body .grafana-app .dashboard-content .panel-wrapper {\n          height: 100%;\n        }\n\n        body .grafana-app .panel-menu-container {\n          display: none;\n        }\n\n        body .grafana-app .panel-title {\n          cursor: default;\n        }\n\n        body .grafana-app .panel-title .panel-title-text div {\n          display: none;\n        }\n      `;const a=null===(e=this.$refs.frame)||void 0===e?void 0:e.contentWindow,r=null===a||void 0===a?void 0:a.document;r.head&&r.head.appendChild(t)},inject(){this.injectCss()}}},x=w,$=(a("fbd4"),Object(u["a"])(x,m,f,!1,null,"eeaaabda",null)),_=$.exports,T=a("9ce4"),S={components:{DashboardOptions:p,GrafanaDashboard:_},props:{detailUrl:{type:String,required:!0},summaryUrl:{type:String,default:""},vars:{type:Object,default:()=>({})},graphHeight:{type:String,required:!0},hasSummaryAndDetail:{type:Boolean,default:!0},modifyPrefix:{type:Boolean,default:!0}},data(){return{graphOptions:{range:"5m",refreshRate:"30s",type:"detail"}}},computed:{...Object(T["a"])(["prefs/theme"]),graphBackgroundColor(){return"dark"===this.theme?"#2e3035":"#f3f4f9"},theme(){return this["prefs/theme"]}}},k=S,C=(a("b661"),Object(u["a"])(k,r,s,!1,null,"1e72d538",null));t["a"]=C.exports},c422:function(e,t,a){"use strict";var r=function(){var e=this,t=e._self._c;return t("Tabbed",e._b({attrs:{"default-tab":e.defaultTab},on:{changed:e.tabChange}},"Tabbed",e.$attrs,!1),[e._t("default"),e.showConditions?t("Tab",{attrs:{"label-key":"resourceTabs.conditions.tab",name:"conditions",weight:-1,"display-alert-icon":e.conditionsHaveIssues}},[t("Conditions",{attrs:{value:e.value}})],1):e._e(),e.showEvents?t("Tab",{attrs:{"label-key":"resourceTabs.events.tab",name:"events",weight:-2}},["events"===e.selectedTab?t("SortableTable",{attrs:{rows:e.events,headers:e.eventHeaders,"key-field":"id",search:!1,"table-actions":!1,"row-actions":!1,"default-sort-by":"date"}}):e._e()],1):e._e(),e.showRelated?t("Tab",{attrs:{name:"related","label-key":"resourceTabs.related.tab",weight:-3}},[t("h3",{directives:[{name:"t",rawName:"v-t",value:"resourceTabs.related.from",expression:"'resourceTabs.related.from'"}]}),t("RelatedResources",{attrs:{"ignore-types":[e.value.type],value:e.value,direction:"from"}}),t("h3",{directives:[{name:"t",rawName:"v-t",value:"resourceTabs.related.to",expression:"'resourceTabs.related.to'"}],staticClass:"mt-20"}),t("RelatedResources",{attrs:{"ignore-types":[e.value.type],value:e.value,direction:"to"}})],1):e._e(),e._l(e.extensionTabs,(function(a,r){return t("Tab",{key:`${a.name}${r}`,attrs:{name:a.name,label:a.label,"label-key":a.labelKey,weight:a.weight,tooltip:a.tooltip,"show-header":a.showHeader,"display-alert-icon":a.displayAlertIcon,error:a.error,badge:a.badge}},[t(a.component,{tag:"component",attrs:{resource:e.value}})],1)}))],2)},s=[],i=a("0cb2"),n=a("38de"),o=a("305c"),l=function(){var e=this,t=e._self._c;return t("SortableTable",{attrs:{headers:e.headers,rows:e.rows,"key-field":"condition","default-sort-by":"condition","table-actions":!1,"row-actions":!1,search:!1},scopedSlots:e._u([{key:"cell:condition",fn:function({row:a}){return[t("span",{class:{"text-error":a.error}},[e._v(e._s(a.condition))])]}},{key:"cell:status",fn:function({row:a}){return[t("span",{class:{"text-error":a.error}},[e._v(e._s(a.status))])]}}])})},d=[],c=a("0fb1"),u={components:{SortableTable:c["b"]},props:{value:{type:Object,default:()=>({})}},computed:{headers(){return[{name:"condition",labelKey:"tableHeaders.condition",value:"condition",width:150,sort:"condition",dashIfEmpty:!0},{name:"status",labelKey:"tableHeaders.status",value:"status",width:75,sort:"status",dashIfEmpty:!0},{name:"time",labelKey:"tableHeaders.updated",value:"time",sort:"time",formatter:"LiveDate",formatterOpts:{addSuffix:!0},width:125,dashIfEmpty:!0},{name:"message",labelKey:"tableHeaders.message",value:"message",sort:["message"],dashIfEmpty:!0}]},rows(){var e;return((null===(e=this.value.status)||void 0===e?void 0:e.conditions)||[]).map(e=>{let t=e.message||"";return e.reason&&(t=`[${e.reason}] ${t}`.trim()),{condition:e.type||"Unknown",status:e.status||"Unknown",error:e.error,time:e.lastProbeTime||e.lastUpdateTime||e.lastTransitionTime,message:t}})}}},h=u,p=a("d802"),m=Object(p["a"])(h,l,d,!1,null,null,null),f=m.exports,g=a("907c"),b=a("da25"),v=function(){var e=this,t=e._self._c;return t("ResourceTable",{attrs:{schema:null,rows:e.rows,headers:e.headers,search:!1,"table-actions":!1,namespaced:!0,"mangle-action-resources":e.getRealResources,"paging-label":"sortableTable.paging.generic",groupable:!1},scopedSlots:e._u([{key:"cell:state",fn:function({row:e}){return[e.real?t("BadgeState",{attrs:{value:e.real}}):t("BadgeState",{attrs:{value:e}})]}}])})},y=[],w=a("126f"),x=a("9c09"),$=a("462f"),_=a("1d19"),T=a("bcb3"),S=a("f17a"),k={components:{ResourceTable:w["a"],BadgeState:S["a"]},props:{value:{type:Object,required:!0},rel:{type:String,default:null},direction:{type:String,default:"to"},ignoreTypes:{type:Array,default:()=>[]}},data(){return{loadedResources:1}},computed:{filteredRelationships(){var e;let t=(null===(e=this.value)||void 0===e||null===(e=e.metadata)||void 0===e?void 0:e.relationships)||[];return t=t.filter(e=>{const t=e[this.direction+"Type"];return!(!t||this.ignoreTypes.includes(t))&&(!this.rel||e.rel===this.rel)}),t},rows(){if(this.loadedResources<1)return;const e=this.$store.getters["clusterId"],t=this.$store.getters["currentStore"](),a=[];for(const r of this.filteredRelationships){const s=r.state||"active",i=Object(x["b"])(s,r.error,r.transitioning),n=r[this.direction+"Type"],o=this.$store.getters[t+"/schemaFor"](n);let l=r[this.direction+"Id"];if(!l)continue;let d=null;const c=l.indexOf("/"),u=`${n}/${d}/${l}`;c>0&&(d=l.substr(0,c),l=l.substr(c+1));const h={name:`c-cluster-product-resource${d?"-namespace":""}-id`,params:{product:T["a"],cluster:"management"===t?"local":e,resource:n,namespace:d,id:l}};a.push({type:n,real:this.$store.getters[t+"/byId"](n,r[this.direction+"Id"]),id:r[this.direction+"Id"],state:s,metadata:{namespace:d,name:l},_key:u,name:l,namespace:d,nameDisplay:l,nameSort:Object(_["b"])(l).toLowerCase(),stateColor:i,detailLocation:h,typeDisplay:this.$store.getters["type-map/labelFor"](o),stateDisplay:Object(x["e"])(s),stateBackground:i.replace("text-","bg-"),groupByLabel:d})}return a},headers(){return[$["K"],$["P"],$["u"],$["v"]]}},methods:{async getRealResources(e){const t=this.$store.getters["currentStore"](),a=await Promise.allSettled(e.map(e=>this.$store.dispatch(t+"/find",{type:e.type,id:e.id}))),r=[];for(let s=0;s<a.length;s++)"fulfilled"===a[s].status&&r.push(a[s].value);return this.loadedResources++,r}}},C=k,O=Object(p["a"])(C,v,y,!1,null,null,null),E=O.exports,j=a("7083"),L=a("1722"),R={name:"ResourceTabs",components:{Tabbed:i["a"],Tab:n["a"],Conditions:f,SortableTable:c["b"],RelatedResources:E},mixins:[o["a"]],props:{value:{type:Object,default:()=>({})},mode:{type:String,default:b["t"]},defaultTab:{type:String,default:null},needConditions:{type:Boolean,default:!0},needEvents:{type:Boolean,default:!0},needRelated:{type:Boolean,default:!0},extensionParams:{type:Object,default:null}},data(){const e=this.$store.getters["currentStore"](g["g"]);return{hasEvents:this.$store.getters[e+"/schemaFor"](g["g"]),allEvents:[],selectedTab:this.defaultTab,didLoadEvents:!1,extensionTabs:Object(L["a"])(this,j["c"].TAB,j["e"].RESOURCE_DETAIL,this.$route,this,this.extensionParams)}},beforeDestroy(){this.$store.dispatch("cluster/forgetType",g["g"])},computed:{showConditions(){const e=this.$store.getters["currentStore"](this.value.type);var t;return!!this.$store.getters[e+"/schemaFor"](this.value.type)&&(this.isView&&this.needConditions&&(null===(t=this.value)||void 0===t?void 0:t.type)&&this.$store.getters[e+"/pathExistsInSchema"](this.value.type,"status.conditions"))},showEvents(){return this.isView&&this.needEvents&&this.hasEvents},showRelated(){return this.isView&&this.needRelated},eventHeaders(){return[{name:"type",label:this.t("tableHeaders.type"),value:"eventType",sort:"eventType"},{name:"reason",label:this.t("tableHeaders.reason"),value:"reason",sort:"reason"},{name:"date",label:this.t("tableHeaders.updated"),value:"date",sort:"date:desc",formatter:"LiveDate",formatterOpts:{addSuffix:!0},width:125},{name:"message",label:this.t("tableHeaders.message"),value:"message",sort:"message"}]},events(){return this.allEvents.filter(e=>{var t,a;return(null===(t=e.involvedObject)||void 0===t?void 0:t.uid)===(null===(a=this.value)||void 0===a||null===(a=a.metadata)||void 0===a?void 0:a.uid)}).map(e=>({reason:`${e.reason||this.t("generic.unknown")}${e.count>1?` (${e.count})`:""}`.trim(),message:e.message||this.t("generic.unknown"),date:e.lastTimestamp||e.firstTimestamp||e.metadata.creationTimestamp,eventType:e.eventType}))},conditionsHaveIssues(){var e;return!!this.showConditions&&(null===(e=this.value.status)||void 0===e||null===(e=e.conditions)||void 0===e?void 0:e.filter(e=>!Object(x["d"])(e)).some(e=>e.error))}},methods:{tabChange(e){if(this.selectedTab=null===e||void 0===e?void 0:e.selectedName,!this.didLoadEvents&&"events"===this.selectedTab){const e=this.$store.getters["currentStore"](g["g"]);this.$store.dispatch(e+"/findAll",{type:g["g"]}).then(e=>{this.allEvents=e,this.didLoadEvents=!0})}}}},B=R,I=Object(p["a"])(B,r,s,!1,null,null,null);t["a"]=I.exports},d651:function(e,t,a){var r=a("5a41");r.__esModule&&(r=r.default),"string"===typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);var s=a("0ed3").default;s("61c7a370",r,!0,{sourceMap:!1,shadowMode:!1})},e7f7:function(e,t,a){var r=a("5eaa");t=r(!1),t.push([e.i,".fixed-top-banner[data-v-0c9f6175]{top:calc(2em + var(--header-height))}.fixed-one-banner[data-v-0c9f6175]{height:calc(100vh - var(--header-height) - 2em)}.fixed-two-banners[data-v-0c9f6175]{height:calc(100vh - var(--header-height) - 4em)}.ember-page[data-v-0c9f6175]{display:flex;height:100%;padding:0}.frame[data-v-0c9f6175]{flex:1;visibility:hidden}.frame.pop[data-v-0c9f6175]{margin:-20px}.loading[data-v-0c9f6175]{visibility:visible}.ember-page-error[data-v-0c9f6175]{display:flex;align-items:center;flex:1;flex-direction:column;justify-content:center}.ember-page-error>div[data-v-0c9f6175]{font-size:20px;padding-bottom:20px}.inline-loading[data-v-0c9f6175]{border:1px solid var(--border);border-radius:5px;padding:10px;text-align:center;width:100%}",""]),e.exports=t},f1ea:function(e,t,a){"use strict";var r=function(){var e=this,t=e._self._c;return e.shown?t("div",e._g({staticClass:"simple-box",attrs:{"data-testid":"simple-box-container"}},e.$listeners),[e.title||e.canClose||e.$slots.title?t("div",{staticClass:"top"},[e._t("title",(function(){return[e.title?t("h2",{attrs:{"data-testid":"simple-box-title"}},[e._v(" "+e._s(e.title)+" ")]):e._e()]})),e.canClose||e.pref?t("div",{staticClass:"close-button",attrs:{"data-testid":"simple-box-close"},on:{click:function(t){return e.closeBox(t)}}},[t("i",{staticClass:"icon icon-close"})]):e._e()],2):e._e(),t("div",{staticClass:"content"},[e._t("default")],2)]):e._e()},s=[],i={props:{pref:{type:String,default:null},prefKey:{type:String,default:null}},computed:{shown(){let e=!0;if(this.pref){const t=this.$store.getters["prefs/get"](this.pref);e=this.prefKey?!t[this.prefKey]:!t}return e}},methods:{async hide(){if(this.pref){let e=this.$store.getters["prefs/get"](this.pref);this.prefKey&&((!0===e||!1===e||e.length>0)&&(e={}),e[this.prefKey]=!0),await this.$store.dispatch("prefs/set",{key:this.pref,value:e})}}}},n={name:"SimpleBox",mixins:[i],props:{title:{type:String,default:null},canClose:{type:Boolean,default:!1}},methods:{closeBox(e){this.hide(),this.$emit("close",e)}}},o=n,l=(a("f282"),a("5755"),a("d802")),d=Object(l["a"])(o,r,s,!1,null,"764cb044",null);t["a"]=d.exports},f282:function(e,t,a){"use strict";a("291f")},fbd4:function(e,t,a){"use strict";a("6306")}}]);
//# sourceMappingURL=hpc-ui-1.1.3.umd.min.vendors~detail.js.map